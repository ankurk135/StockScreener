<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Screener</title>
    
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    
    <link rel="stylesheet" href="/static/css/screener.css">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-left">
            <div class="navbar-brand">Stock Screener</div>
            <div class="navbar-actions">
                <button class="nav-btn primary" onclick="refreshData()" id="refreshBtn">
                    Refresh Data
                </button>
                <div class="columns-dropdown">
                    <button class="nav-btn" onclick="toggleColumnsMenu()">
                        Columns
                    </button>
                    <div class="columns-menu" id="columnsMenu">
                        <div class="column-item">
                            <input type="checkbox" id="toggle-price" checked onchange="toggleColumnGroup('price')">
                            <label for="toggle-price">Price Metrics (9)</label>
                        </div>
                        <div class="column-item">
                            <input type="checkbox" id="toggle-trend" checked onchange="toggleColumnGroup('trend')">
                            <label for="toggle-trend">Trend Indicators (8)</label>
                        </div>
                        <div class="column-item">
                            <input type="checkbox" id="toggle-momentum" checked onchange="toggleColumnGroup('momentum')">
                            <label for="toggle-momentum">Momentum (8)</label>
                        </div>
                        <div class="column-item">
                            <input type="checkbox" id="toggle-volume" checked onchange="toggleColumnGroup('volume')">
                            <label for="toggle-volume">Volume (6)</label>
                        </div>
                        <div class="column-item">
                            <input type="checkbox" id="toggle-money-flow" checked onchange="toggleColumnGroup('money-flow')">
                            <label for="toggle-money-flow">Money Flow (4)</label>
                        </div>
                        <div class="column-item">
                            <input type="checkbox" id="toggle-strength" checked onchange="toggleColumnGroup('strength')">
                            <label for="toggle-strength">Rel. Strength (3)</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="navbar-right">
            <span class="status-badge" id="statusText">No data loaded</span>
        </div>
    </nav>
    
    <div class="filters-bar" id="filtersBar">
        <span class="filters-label">
            <span>Active Filters</span>
            <span style="background: #667eea; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.75rem;" id="filterCount">0</span>
        </span>
        <div class="filter-chips" id="filterChips"></div>
        <button class="clear-all-btn" onclick="clearAllFilters()">Clear All</button>
    </div>
    
    <div class="message" id="message"></div>
    
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p style="font-size: 1.1rem; font-weight: 600; margin-bottom: 8px;">Processing stock data...</p>
            <p style="color: #666;">This may take several minutes</p>
        </div>
    </div>
    
    <div class="main-content">
        <div class="table-controls">
            <div id="tableLength"></div>
            <div id="tableFilter"></div>
        </div>
        
        <div class="table-container">
            <table id="stockTable">
                <thead>
                    <tr>
                        <th class="col-basic">
                            <div class="th-content"><span class="th-line1">Stock</span><span class="th-line2">Name</span></div>
                        </th>
                        <th class="col-basic">
                            <div class="th-content"><span class="th-line1">Sector</span></div>
                            <span class="filter-icon" data-col="1"></span>
                        </th>
                        <th class="col-basic">
                            <div class="th-content"><span class="th-line1">Industry</span></div>
                            <span class="filter-icon" data-col="2"></span>
                        </th>
                        <th class="col-price num">
                            <div class="th-content"><span class="th-line1">Price</span><span class="th-line2">(â‚¹)</span></div>
                            <span class="filter-icon" data-col="3"></span>
                        </th>
                        <th class="col-price num">
                            <div class="th-content"><span class="th-line1">1Day</span><span class="th-line2">%</span></div>
                            <span class="filter-icon" data-col="4"></span>
                        </th>
                        <th class="col-price num">
                            <div class="th-content"><span class="th-line1">5Day</span><span class="th-line2">%</span></div>
                            <span class="filter-icon" data-col="5"></span>
                        </th>
                        <th class="col-price num">
                            <div class="th-content"><span class="th-line1">11Day</span><span class="th-line2">%</span></div>
                            <span class="filter-icon" data-col="6"></span>
                        </th>
                        <th class="col-price num">
                            <div class="th-content"><span class="th-line1">P/E</span><span class="th-line2">Ratio</span></div>
                            <span class="filter-icon" data-col="7"></span>
                        </th>
                        <th class="col-trend num">
                            <div class="th-content"><span class="th-line1">SuperTrend</span><span class="th-line2">1D</span></div>
                            <span class="filter-icon" data-col="8"></span>
                        </th>
                        <th class="col-trend num">
                            <div class="th-content"><span class="th-line1">SuperTrend</span><span class="th-line2">1W</span></div>
                            <span class="filter-icon" data-col="9"></span>
                        </th>
                        <th class="col-trend num">
                            <div class="th-content"><span class="th-line1">SMA50</span><span class="th-line2">1D</span></div>
                            <span class="filter-icon" data-col="10"></span>
                        </th>
                        <th class="col-trend num">
                            <div class="th-content"><span class="th-line1">SMA50</span><span class="th-line2">Away%</span></div>
                            <span class="filter-icon" data-col="11"></span>
                        </th>
                        <th class="col-trend num">
                            <div class="th-content"><span class="th-line1">SMA200</span><span class="th-line2">1D</span></div>
                            <span class="filter-icon" data-col="12"></span>
                        </th>
                        <th class="col-trend num">
                            <div class="th-content"><span class="th-line1">SMA200</span><span class="th-line2">Away%</span></div>
                            <span class="filter-icon" data-col="13"></span>
                        </th>
                        <th class="col-trend num">
                            <div class="th-content"><span class="th-line1">SMA200</span><span class="th-line2">1W</span></div>
                            <span class="filter-icon" data-col="14"></span>
                        </th>
                        <th class="col-trend">
                            <div class="th-content"><span class="th-line1">GC/DC</span></div>
                            <span class="filter-icon" data-col="15"></span>
                        </th>
                        <th class="col-momentum num">
                            <div class="th-content"><span class="th-line1">RSI</span><span class="th-line2">1D</span></div>
                            <span class="filter-icon" data-col="16"></span>
                        </th>
                        <th class="col-momentum num">
                            <div class="th-content"><span class="th-line1">RSI</span><span class="th-line2">1W</span></div>
                            <span class="filter-icon" data-col="17"></span>
                        </th>
                        <th class="col-momentum num">
                            <div class="th-content"><span class="th-line1">MACD</span><span class="th-line2">1D</span></div>
                            <span class="filter-icon" data-col="18"></span>
                        </th>
                        <th class="col-momentum num">
                            <div class="th-content"><span class="th-line1">MACD Sig</span><span class="th-line2">1D</span></div>
                            <span class="filter-icon" data-col="19"></span>
                        </th>
                        <th class="col-momentum">
                            <div class="th-content"><span class="th-line1">Cross</span><span class="th-line2">1D</span></div>
                            <span class="filter-icon" data-col="20"></span>
                        </th>
                        <th class="col-momentum num">
                            <div class="th-content"><span class="th-line1">MACD</span><span class="th-line2">1W</span></div>
                            <span class="filter-icon" data-col="21"></span>
                        </th>
                        <th class="col-momentum num">
                            <div class="th-content"><span class="th-line1">MACD Sig</span><span class="th-line2">1W</span></div>
                            <span class="filter-icon" data-col="22"></span>
                        </th>
                        <th class="col-momentum">
                            <div class="th-content"><span class="th-line1">Cross</span><span class="th-line2">1W</span></div>
                            <span class="filter-icon" data-col="23"></span>
                        </th>
                        <th class="col-volume num">
                            <div class="th-content"><span class="th-line1">Vol</span><span class="th-line2">Change%</span></div>
                            <span class="filter-icon" data-col="24"></span>
                        </th>
                        <th class="col-volume num">
                            <div class="th-content"><span class="th-line1">RelVol</span><span class="th-line2">1D/10D</span></div>
                            <span class="filter-icon" data-col="25"></span>
                        </th>
                        <th class="col-volume num">
                            <div class="th-content"><span class="th-line1">RelVol</span><span class="th-line2">1D/30D</span></div>
                            <span class="filter-icon" data-col="26"></span>
                        </th>
                        <th class="col-volume num">
                            <div class="th-content"><span class="th-line1">RelVol</span><span class="th-line2">10D/30D</span></div>
                            <span class="filter-icon" data-col="27"></span>
                        </th>
                        <th class="col-volume num">
                            <div class="th-content"><span class="th-line1">RelVol</span><span class="th-line2">10D/60D</span></div>
                            <span class="filter-icon" data-col="28"></span>
                        </th>
                        <th class="col-volume num">
                            <div class="th-content"><span class="th-line1">RelVol</span><span class="th-line2">10D/90D</span></div>
                            <span class="filter-icon" data-col="29"></span>
                        </th>
                        <th class="col-money-flow num">
                            <div class="th-content"><span class="th-line1">MFI</span></div>
                            <span class="filter-icon" data-col="30"></span>
                        </th>
                        <th class="col-money-flow num">
                            <div class="th-content"><span class="th-line1">CMF</span></div>
                            <span class="filter-icon" data-col="31"></span>
                        </th>
                        <th class="col-money-flow num">
                            <div class="th-content"><span class="th-line1">B/S</span><span class="th-line2">Pressure</span></div>
                            <span class="filter-icon" data-col="32"></span>
                        </th>
                        <th class="col-money-flow num">
                            <div class="th-content"><span class="th-line1">VPT</span><span class="th-line2">11D%</span></div>
                            <span class="filter-icon" data-col="33"></span>
                        </th>
                        <th class="col-strength num">
                            <div class="th-content"><span class="th-line1">RelStr</span><span class="th-line2">18D</span></div>
                            <span class="filter-icon" data-col="34"></span>
                        </th>
                        <th class="col-strength num">
                            <div class="th-content"><span class="th-line1">RelStr</span><span class="th-line2">55D</span></div>
                            <span class="filter-icon" data-col="35"></span>
                        </th>
                        <th class="col-strength num">
                            <div class="th-content"><span class="th-line1">RelStr</span><span class="th-line2">81D</span></div>
                            <span class="filter-icon" data-col="36"></span>
                        </th>
                        <th class="col-price num">
                            <div class="th-content"><span class="th-line1">52W</span><span class="th-line2">High</span></div>
                            <span class="filter-icon" data-col="37"></span>
                        </th>
                        <th class="col-price num">
                            <div class="th-content"><span class="th-line1">52W</span><span class="th-line2">Low</span></div>
                            <span class="filter-icon" data-col="38"></span>
                        </th>
                        <th class="col-price num">
                            <div class="th-content"><span class="th-line1">5Year</span><span class="th-line2">High</span></div>
                            <span class="filter-icon" data-col="39"></span>
                        </th>
                        <th class="col-price num">
                            <div class="th-content"><span class="th-line1">5Year</span><span class="th-line2">Low</span></div>
                            <span class="filter-icon" data-col="40"></span>
                        </th>
                    </tr>
                </thead>
                <tbody id="stockData">
                    <tr>
                        <td colspan="41" style="text-align:center;padding:60px;color:#999;">
                            <div style="font-size:1.2rem;margin-bottom:10px;">No data loaded</div>
                            <div>Click "Refresh Data" to fetch stocks</div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="table-footer">
            <div id="tableInfo"></div>
            <div id="tablePaginate"></div>
        </div>
    </div>

    <script src="/static/js/screener.js"></script>
</body>
</html>